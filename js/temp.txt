<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Item Level App</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    background: #f7f8fa;
    padding: 2rem;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  h1 {
    margin-bottom: 1rem;
  }

  #itemInput {
    padding: 0.5rem 1rem;
    font-size: 1rem;
    margin-right: 0.5rem;
  }

  #addBtn {
    padding: 0.5rem 1rem;
    background: #4f46e5;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }

  #addBtn:hover {
    background: #3730a3;
  }

  .group {
    margin-top: 1rem;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    align-items: center;
  }

  .group-number {
    font-weight: bold;
    margin-right: 0.5rem;
  }

  .item {
    background: white;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 0.4rem 0.8rem;
    cursor: pointer;
    transition: transform 0.1s ease, background 0.2s ease;
  }

  .item:hover {
    background: #eef;
    transform: scale(1.05);
  }
</style>
</head>
<body>

<h1>Item Level App</h1>
<div>
  <input id="itemInput" type="text" placeholder="Enter item name">
  <button id="addBtn">Add Item</button>
</div>

<div id="itemList"></div>

<script>
  const STORAGE_KEY = 'itemListAppData';
  let items = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

  const itemList = document.getElementById('itemList');
  const addBtn = document.getElementById('addBtn');
  const itemInput = document.getElementById('itemInput');

  function saveItems() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
  }

  function renderItems() {
    itemList.innerHTML = '';
    // Filter out items with number > 119 for display
    const visibleItems = items.filter(i => i.number <= 119);

    // Group items by number
    const grouped = {};
    visibleItems.forEach(item => {
      if (!grouped[item.number]) grouped[item.number] = [];
      grouped[item.number].push(item);
    });

    // Sort descending by number
    const sortedNumbers = Object.keys(grouped).map(Number).sort((a, b) => b - a);

    sortedNumbers.forEach(num => {
      const groupDiv = document.createElement('div');
      groupDiv.className = 'group';
      
      const numSpan = document.createElement('span');
      numSpan.className = 'group-number';
      numSpan.textContent = num;
      groupDiv.appendChild(numSpan);

      grouped[num].forEach(item => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'item';
        itemDiv.textContent = item.name;
        itemDiv.onclick = () => incrementItem(item.name);
        groupDiv.appendChild(itemDiv);
      });

      itemList.appendChild(groupDiv);
    });
  }

  function addItem() {
    const name = itemInput.value.trim();
    if (!name) return;
    const now = Date.now();
    items.push({
      name,
      number: 60,
      createdAt: now,
      updatedAt: now
    });
    saveItems();
    renderItems();
    itemInput.value = '';
  }

  function incrementItem(name) {
    const item = items.find(i => i.name === name);
    if (!item) return;
    item.number++;
    item.updatedAt = Date.now();
    saveItems();
    renderItems();
  }

  addBtn.onclick = addItem;
  itemInput.addEventListener('keypress', e => {
    if (e.key === 'Enter') addItem();
  });

  renderItems();
</script>

</body>
</html>
